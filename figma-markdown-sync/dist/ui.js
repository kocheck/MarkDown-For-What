(()=>{"use strict";({60:function(){var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))(function(r,i){function l(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(l,a)}s((o=o.apply(e,n||[])).next())})},n=this&&this.__generator||function(e,n){var t,o,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(s){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],o=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};console.log("UI script starting...");var t=document.getElementById("drop-zone"),o=document.getElementById("file-input"),r=document.getElementById("browse-btn"),i=document.getElementById("preview-area"),l=document.getElementById("file-content"),a=document.getElementById("import-btn"),s=document.getElementById("status-message");t||console.error("Error: drop-zone not found"),o||console.error("Error: file-input not found"),r||console.error("Error: browse-btn not found"),a||console.error("Error: import-btn not found"),console.log("UI Elements initialized",{dropZone:t,fileInput:o,browseBtn:r});var c=[];function u(e){return new Promise(function(n,t){if(e.name.endsWith(".md")||e.name.endsWith(".markdown")||e.name.endsWith(".txt")){var o=new FileReader;o.onload=function(t){var o;n({name:e.name,content:null===(o=t.target)||void 0===o?void 0:o.result})},o.onerror=function(){return t(new Error("Failed to read ".concat(e.name)))},o.readAsText(e)}else n({name:e.name,content:""})})}function d(t){return e(this,void 0,void 0,function(){var e,o,r,s,d;return n(this,function(n){switch(n.label){case 0:c=[],f("Reading files...","success"),a&&(a.disabled=!0),n.label=1;case 1:for(n.trys.push([1,3,,4]),e=[],o=0;o<t.length;o++)e.push(u(t[o]));return[4,Promise.all(e)];case 2:return r=n.sent(),0===(c=r.filter(function(e){return""!==e.content})).length?(f("No valid markdown files found.","error"),i&&i.classList.remove("visible"),[2]):(l&&(1===c.length?(s=c[0].content,l.textContent=s.substring(0,500)+(s.length>500?"...":"")):l.textContent="Selected ".concat(c.length," files:\n")+c.map(function(e){return"- ".concat(e.name)}).join("\n")),i&&i.classList.add("visible"),a&&(a.disabled=!1,a.innerText=c.length>1?"Import ".concat(c.length," Files"):"Import to Selected Layer(s)"),f("Ready to import ".concat(c.length," file").concat(1===c.length?"":"s"),"success"),[3,4]);case 3:return d=n.sent(),console.error(d),f("Error reading files","error"),[3,4];case 4:return[2]}})})}function f(e,n){void 0===n&&(n="success"),s&&(s.textContent=e,s.className="status-message ".concat(n))}t&&(t.addEventListener("dragover",function(e){e.preventDefault(),t.classList.add("drag-over")}),t.addEventListener("dragleave",function(){t.classList.remove("drag-over")}),t.addEventListener("drop",function(e){var n;e.preventDefault(),t.classList.remove("drag-over"),console.log("File dropped"),(null===(n=e.dataTransfer)||void 0===n?void 0:n.files.length)&&d(e.dataTransfer.files)}),t.addEventListener("click",function(e){e.target!==r&&(console.log("Dropzone clicked (background)"),null==o||o.click())})),r?r.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),console.log("Browse button clicked"),o?(console.log("Triggering file input click"),o.click()):console.error("File input missing when browse clicked")}):console.warn("Browse button listener NOT attached (element missing)"),null==o||o.addEventListener("change",function(e){var n,t,o=e.target;console.log("File input changed",null===(n=o.files)||void 0===n?void 0:n.length),(null===(t=o.files)||void 0===t?void 0:t.length)&&d(o.files)}),null==a||a.addEventListener("click",function(){0!==c.length&&parent.postMessage({pluginMessage:{type:"import-markdown-batch",files:c}},"*")}),window.onmessage=function(e){var n=e.data.pluginMessage;"status"===n.type&&f(n.message,n.error?"error":"success")}}})[60].call({})})();